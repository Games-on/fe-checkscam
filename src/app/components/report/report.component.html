  <div class="container-fluid">
    <div class="header-actions">
      <h1 class="h3 mb-2 text-gray-800">Quản lý báo cáo</h1>
    </div>
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Danh sách báo cáo</h6>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
            <div class="row">
              <div class="col-sm-12 col-md-6">
                <div id="dataTable_filter" class="dataTables_filter"></div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <table class="table table-bordered dataTable" id="dataTable" width="100%" cellspacing="0" role="grid"
                  aria-describedby="dataTable_info" style="width: 100%;">
                  <thead>
                    <tr role="row">
                      <th aria-controls="dataTable" rowspan="1" colspan="1" aria-sort="ascending" style="width: 20px;">ID
                      </th>
                      <th class="sorting" tabindex="0" rowspan="1" colspan="1" style="width: 150px;">Thông tin</th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1"
                        style="width: 250px;">Mô tả</th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1"
                        style="width: 78.2px;">Trạng thái</th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1"
                        style="width: 78.2px;">Loại</th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1"
                        style="width: 78.2px;">Duyệt</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let report of reports">

                      <td>{{ report.id }}</td>

                      <td>
                        <a routerLink="/admin/detail-report/{{ report.id }}">{{ report.info }}</a>
                      </td>

                      <td>{{ report.description }}</td>

                      <td>{{ report.status | reportStatusToString }}</td>

                      <td>{{ report.type | informationTypeToString }}</td>

                      <td class="action-cell">
                        <!-- NÚT XÁC NHẬN -->
                        <button class="icon-button" title="Xác nhận" (click)="openDropdown(report.id)">
                          <i class="fa-solid fa-check"></i>
                        </button>

                        <!-- NÚT TỪ CHỐI -->
                        <button class="icon-button" title="Từ chối" (click)="rejectReport(report.id)">
                          <i class="fa-solid fa-xmark"></i>
                        </button>

                        <div *ngIf="dropdownOpenForId === report.id" class="dropdown-card"
                          (click)="$event.stopPropagation()">

                          <select [(ngModel)]="selectedScamTypeId">
                            <option [ngValue]="null" disabled selected>-- Chọn hình thức --</option>
                            <option *ngFor="let s of scamTypes" [ngValue]="s.id">
                              {{ s.name }} ({{ s.code }})
                            </option>
                            <option [ngValue]="0">➕ Thêm mới…</option>
                          </select>

                          <div *ngIf="selectedScamTypeId === 0" class="new-box">
                            <input type="text" placeholder="Tên" [(ngModel)]="newScamType.name">
                            <input type="text" placeholder="Mã" [(ngModel)]="newScamType.code">
                            <button (click)="createScamTypeAndConfirm(report.id)">Lưu & xác nhận</button>
                          </div>

                          <div *ngIf="selectedScamTypeId && selectedScamTypeId !== 0">
                            <button (click)="confirmReport(report.id)">Xác nhận</button>
                          </div>

                          <button class="close-btn" (click)="closeDropdown()">✕</button>
                        </div>
                      </td>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>